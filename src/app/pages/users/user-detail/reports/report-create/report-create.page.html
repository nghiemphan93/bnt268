<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>Tổng kết</ion-title>
    </ion-toolbar>
</ion-header>

<!--  Main Table Content for Desktop  -->
<ion-content *ngIf="isDesktop">
    <ion-grid>
        <ion-row>
            <ion-col
                    sizeXl="8"
                    offsetXl="2"
                    sizeLg="10"
                    offsetLg="1"
                    sizeMd="12"
                    offsetMd="0"
            >
                <section>
                    <ion-button
                            [routerLink]="['/users', userId, 'orders']"
                            color="dark"
                    >
                        <ion-icon name="arrow-back-outline"></ion-icon>
                        Quay về các tháng
                    </ion-button>

                    <h3 class="ion-text-center">
                        <strong>
                            Bảng tổng kết các sản phẩm
                        </strong>
                    </h3>

                    <!--        Products Report Table            -->
                    <ngx-datatable
                            [rows]="productsReportData"
                            [rowHeight]="'auto'"
                            [headerHeight]="50"
                            [ngClass]="tableStyle"
                            [columnMode]="'force'"
                            [footerHeight]="50"
                            class="ion-text-wrap ion-margin-bottom"
                            style="overflow: hidden"
                            #productsTable
                    >
                        <!--    Product Name   -->
                        <ngx-datatable-column
                                name="Tên sản phẩm"
                                prop="productName"
                        >
                            <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                                <ion-badge
                                        *ngIf="row.productName !== undefined"
                                        color="primary"
                                >
                                    {{ row?.productName }}
                                </ion-badge>
                            </ng-template>
                        </ngx-datatable-column>

                        <!--    Quantity   -->
                        <ngx-datatable-column
                                name="Số lượng"
                                prop="quantity"
                        >
                            <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                                <ion-badge
                                        *ngIf="row.quantity !== undefined"
                                        color="tertiary"
                                >
                                    {{ row?.quantity }}
                                </ion-badge>
                            </ng-template>
                        </ngx-datatable-column>

                        <!--    Price   -->
                        <ngx-datatable-column
                                name="Công"
                                prop="price"
                        >
                            <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                                <ion-badge
                                        *ngIf="row.price !== undefined"
                                        color="success"
                                >
                                    {{ row?.price | number:'1.0-2' }} đ
                                </ion-badge>
                            </ng-template>
                        </ngx-datatable-column>

                        <!--    Total   -->
                        <ngx-datatable-column
                                name="Tổng công"
                                prop="totalPrice"
                        >
                            <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                                <ion-badge
                                        *ngIf="row?.price !== undefined"
                                        color="warning"
                                >
                                    {{ row?.price | number:'1.0-2' }} đ x {{ row?.quantity }}
                                    = {{ row?.totalPrice | number:'1.0-2' }} đ
                                </ion-badge>

                                <ion-badge
                                        *ngIf="row?.price === undefined"
                                        color="danger"
                                >
                                    Tổng {{ row?.totalPrice | number:'1.0-2' }} đ
                                </ion-badge>
                            </ng-template>
                        </ngx-datatable-column>

                        <ion-col
                                *ngIf="productsTable.rowCount === 0"
                                size="6"
                                offset="5"
                        >
                            <ion-spinner class="spinner-loading"></ion-spinner>
                        </ion-col>
                    </ngx-datatable>

                    <hr>

                    <ion-grid fixed>
                        <ion-row>
                            <ion-col
                                    sizeXl="10"
                                    offsetXl="1"
                                    sizeLg="12"
                                    offsetLg="0"
                                    sizeMd="12"
                                    offsetMd="0"
                                    sizeSm="12"
                                    offsetSm="0"
                                    sizeXs="12"
                                    offsetXs="0"
                            >
                                <h3 class="ion-text-center">
                                    <strong>
                                        Bảng tổng kết bạc Giao/ Nhận
                                    </strong>
                                </h3>


                                <!--        Silver Report Table            -->
                                <ngx-datatable
                                        [rows]="silverReportData"
                                        [rowHeight]="'auto'"
                                        [headerHeight]="50"
                                        [ngClass]="tableStyle"
                                        [columnMode]="'force'"
                                        [footerHeight]="50"
                                        class="ion-text-wrap"
                                        style="overflow: hidden"
                                        #silverTable
                                >
                                    <!--    First Column   -->
                                    <ngx-datatable-column
                                            name="Chi tiết"
                                            prop="firstColumn"
                                    >
                                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                                            <ion-badge
                                                    *ngIf="row.firstColumn !== ''"
                                                    color="primary"
                                            >
                                                {{ row?.firstColumn }}
                                            </ion-badge>
                                        </ng-template>
                                    </ngx-datatable-column>

                                    <!--    Give Weight   -->
                                    <ngx-datatable-column
                                            name="Giao"
                                            prop="giveWeight"
                                    >
                                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                                            <ion-badge
                                                    *ngIf="row.giveWeight !== 0"
                                                    color="tertiary"
                                            >
                                                {{ row?.giveWeight }} chỉ
                                            </ion-badge>
                                        </ng-template>
                                    </ngx-datatable-column>

                                    <!--    Receive Weight   -->
                                    <ngx-datatable-column
                                            name="Nhận"
                                            prop="receiveWeight"
                                    >
                                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                                            <ion-badge
                                                    *ngIf="row.receiveWeight !== 0"
                                                    [color]="row.receiveWeight.includes('Tổng') ? 'danger' : 'warning'"
                                            >
                                                {{ row?.receiveWeight }}
                                            </ion-badge>
                                        </ng-template>
                                    </ngx-datatable-column>

                                    <ion-col
                                            *ngIf="silverTable.rowCount === 0"
                                            size="6"
                                            offset="5"
                                    >
                                        <ion-spinner class="spinner-loading"></ion-spinner>
                                    </ion-col>
                                </ngx-datatable>
                            </ion-col>
                        </ion-row>
                    </ion-grid>

                </section>
            </ion-col>
        </ion-row>
    </ion-grid>

    <ion-footer style="height: 10vh">
    </ion-footer>
</ion-content>
